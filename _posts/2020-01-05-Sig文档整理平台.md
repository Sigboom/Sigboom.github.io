---
layout:     post
title:      "Sig文档整理平台搭建记录"
subtitle:   "so much problem!"
date:       2020-01-05 23:00:00
author:     "Doni Daniel"
header-img: "img/post-bg-rwd.jpg"
catalog: true
tags:
    - 技术
    - 服务器
---

#前言
TencentCloud的使用记录不适合记录开发中的小点和规划。所以就由该文档来记录具体各container的内部细节，也是我的毕业设计过程的一个记录。

##该网站拟实现以下功能：
1. 文档上传与下载功能
	1. 将用户文件上传，并支持后期下载；
	- 文件压缩存储。
2. 文档自动分类
	1. 支持识别用户上传的文档类别并归类存储；
	- 支持多种文档的不同分类方式；
	- 支持自动个性化分类；
	- 支持少量的代码文档类型；
3. 文档主动管理与信息查看
	1. 支持注册用户在网站上创建知识库或文档，并存储到服务端数据库；
	- 公开文档会在网站内展示给所有用户；
	- 提供站内搜索，迅速检索相应用户、标题或内容的文档；
	- 可以关注网站上的其他的用户；
	- 可以对感兴趣的内容进行关注订阅或收藏；
	- 用户可随时对文件进行编辑、删除操作；
	- 可以为文档和知识库增加标签（即关键字）。
	- 可以向用户自动推送关注的用户最近更新的知识库；
4. 分类分享
	1. 注册用户可在网站创建、加入、退出团队，注册后会自动生成一个个人团队；
	- 用户可设置文档或知识库的权限，使文档或知识库仅选择的团队内部可见；
	- 团队成员可集体对文档和知识库进行在线编辑、管理；
	- 用户已加入的团队及其文档会在用户主页单独显示；
	- 设置讨论区块，团队创建者可以发布issue，让团队成员能够集中讨论工作中遇到的问题，交流经验。


##模块划分：
1. 文档管理模块：文档的新建、编辑、发布、搜索以及删除；
2. 知识库管理模块：知识库的建立、搜索、删除以及目录管理；
3. 团队管理模块：团队的建立、搜索、删除以及讨论区主题的发布；
4. 互动模块：热门文章和知识库浏览、关注、收藏以及参与话题讨论；
5. 系统模块：个人信息编辑、用户管理、退出；

##时间规划
- 因为三月中旬就要去实习了，所以想在三月中旬前写出来程序，算下来一共11周时间，去掉过年的一周，就剩下10周时间了，五个模块10周，两周一个模块。
- 当前版本是V1.1.4标志着第一版程序的第一个功能的第4次进步。
- 从1.6-1.19开发第一个功能模块（文档管理模块）


#平台docker框架
<table>
	<tr align=center><th colspan="1">Public</td><th colspan="4">Docker net [daniel-net]</td></tr>
	<tr><td colspan="2"><b>Vue-Nginx 前端管理服务器</b>
		<table><tr align=center><th>前端框架</th><th>静态页面处理</th></tr><tr align="center"><td>Vue</td><td>Nginx</td></tr></table></td><td><b>Apache-Django 后台管理服务器</b>
		<table><tr><th>动态部署</th><th>页面生成</th></tr><tr><td>Apache</td><td>Django</td></tr></table></td><td colspan="2"><b>数据库服务器</b>
		<table><tr><th>缓存</th><td>Redis</td></tr><tr><th>磁盘</th><td>Mysql</td></tr></table></td></tr>
	<tr align=center><th>BASE</th><td>vue-nginx</td><td>apache-django</td><td>redis</td><td>mysql</td></tr>
	<tr><th colspan="5">各版本及实现功能</th></tr>
	<tr align=center><td>V1.0.1</td><td>支持vue</td><td>支持HCJS</td><td colspan="2">支持本地服务</tr>
	<tr align=center><td rowspan="2">V1.0.2</td><td colspan="2">自动化部署</td></tr>
	<tr align=center><td colspan="2">支持动静分离</td></tr>
	<tr align=center><td>V1.0.3</td><td>支持HTTPS</td><td>链接并调用数据库</td><tr>
	<tr align=center><td>V1.1.3</td><td>基本前端页面跳转</td><td>文档的接收与存储</td></tr>
	<tr align=center><td>V1.1.4</td><td>文档上传、下载与删除</td><td>文档的接收与存储</td><td>文件存储与用户存储</td></tr>
	<tr align=center><td>V1.1.5</td><td>手机端显示问题</td></tr>
	<tr align=center><td>V1.1.4</td><td>多文档上传</td><td>多文档的接收与存储</td></tr>
</table>


#前端Vue框架使用记录
##代码目录结构
<table>
	<tr><th colspan="2">docker-vue</th></tr>
	<tr><td>config</td><td>src</td></tr>
</table>

##[安装Bootstrap](https://www.cnblogs.com/wangpengblog/p/10594652.html)
###原因
因为bootstrap依赖jquery，所以在使用npm安装bootstrap前先安装jquery
又因为jquery以来popper.js，所以在安装jquery之前先安装popper
所以安装过程分为三步：1. 使用npm安装popper。2. 使用npm安装jquery。3.使用npm安装boostrap 
 
###一、使用npm安装popper
1. 在build目录下的webpack.base.conf.js中加入

	```py
	const webpack = require("webpack");
	```
2. 在webpack.base.conf.js中module.exports找到plugins（如没有就创建），并添加上

	```py
	plugins: [
     new webpack.ProvidePlugin({
	   Popper:['popper.js','default'],
     })
   ]
	```
![](../img/material.png)

3. 使用npm安装popper

	```sh
	$ npm install popper.js --save-dev
	```

###二、使用npm安装jquery
1. 在package.json文件中找到"dependencies"项，并添加以下代码到其中：

	```py
	"jquery": "^2.2.3"
	```
2. 在build目录下的webpack.base.conf.js中，在module.exports中找到resolve，在其alias项中添加：

	```py
	'jquery':'jquery',
	```
在module.exports中找到plugins，并添加以下代码：
	
	```py
	plugins: [
     new webpack.ProvidePlugin({
       $: "jquery", 
       jQuery: "jquery",
       "windows.jQuery": "jquery",
	    Popper: ['popper.js','default'],
     })
   ]
	```
3. 在main.js中加入以下代码：

	```js
	import $ from 'jquery'
	```
4. 使用npm命令安装

	```sh
	$ npm install jquery@2 install jquery@2.2.3 --save-dev
	```

###三、安装bootstrap
1. 使用npm命令安装

	```sh
	$ npm install bootstrap@3 -S
	```
2. 在需要使用的页面导入bootstrap.min.css/bootstrap.js就可以了。
	
	```js
	import 'bootstrap/dist/css/bootstrap.css'
	import 'bootstrap/dist/js/bootstrap.js'
	```

###四、vue知识点
如果在想要在router-link上添加事件的话需要@click.native这样写


#后台Django框架使用记录


#MySQL与redis使用记录


#TensorFlow使用记录
##创建并配置tensorflow虚拟环境
1. 创建虚拟环境

```sh
conda create -n TF2.0 python=3.6
```

2. 初始化

```sh
conda init bash
```

3. 进入虚拟环境

```sh
conda activate TF2.0
```

4. 添加清华源为下载源

```sh 
conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/

conda config --set show_channel_urls yes
```

5. 安装cuda10.0

```sh
conda install cudatoolkit=10.0
```

6. 安装cudnn7.5.1

```sh
conda install cudnn=7.5.1 -c https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/linux-64/
```

7. 安装Tensorflow2.0

```sh
pip install tensorflow==2.0.0 -i https://pypi.tuna.tsinghua.edu.cn/simple
```

8. 由于目前anaconda不支持tensorflow2.0的安装，只能用pip安装。
测试环境搭建是否成功
运行demo.py（python demo.py)，观察输出的tensorflow版本及是否使用GPU。

demo.py

```py
import tensorflow as tf
version = tf.__version__
gpu_ok = tf.test.is_gpu_available()
print("tf version:",version,"\nuse GPU",gpu_ok)
```

docker pull tensorflow/tensorflow:2.0.0a0-gpu-py3